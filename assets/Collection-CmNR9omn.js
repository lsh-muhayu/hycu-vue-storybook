import{e as h,W as w,r as v,U as O,d,m as I,k as g,w as C,Y as M,V as R}from"./iframe-C4A3u57P.js";import{f as j,S as A}from"./Primitive-CY0unASM.js";function E(n){return typeof n=="string"?`'${n}'`:new B().serialize(n)}const B=(function(){class n{#e=new Map;compare(e,t){const r=typeof e,o=typeof t;return r==="string"&&o==="string"?e.localeCompare(t):r==="number"&&o==="number"?e-t:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(t,!0))}serialize(e,t){if(e===null)return"null";switch(typeof e){case"string":return t?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const t=Object.prototype.toString.call(e);if(t!=="[object Object]")return this.serializeBuiltInType(t.length<10?`unknown:${t}`:t.slice(8,-1),e);const r=e.constructor,o=r===Object||r===void 0?"":r.name;if(o!==""&&globalThis[o]===r)return this.serializeBuiltInType(o,e);if(typeof e.toJSON=="function"){const s=e.toJSON();return o+(s!==null&&typeof s=="object"?this.$object(s):`(${this.serialize(s)})`)}return this.serializeObjectEntries(o,Object.entries(e))}serializeBuiltInType(e,t){const r=this["$"+e];if(r)return r.call(this,t);if(typeof t?.entries=="function")return this.serializeObjectEntries(e,t.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,t){const r=Array.from(t).sort((s,f)=>this.compare(s[0],f[0]));let o=`${e}{`;for(let s=0;s<r.length;s++){const[f,y]=r[s];o+=`${this.serialize(f,!0)}:${this.serialize(y)}`,s<r.length-1&&(o+=",")}return o+"}"}$object(e){let t=this.#e.get(e);return t===void 0&&(this.#e.set(e,`#${this.#e.size}`),t=this.serializeObject(e),this.#e.set(e,t)),t}$function(e){const t=Function.prototype.toString.call(e);return t.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${t.replace(/\s*\n\s*/g,"")}`}$Array(e){let t="[";for(let r=0;r<e.length;r++)t+=this.serialize(e[r]),r<e.length-1&&(t+=",");return t+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((t,r)=>this.compare(t,r)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}for(const i of["Error","RegExp","URL"])n.prototype["$"+i]=function(e){return`${i}(${e})`};for(const i of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])n.prototype["$"+i]=function(e){return`${i}[${e.join(",")}]`};for(const i of["BigInt64Array","BigUint64Array"])n.prototype["$"+i]=function(e){return`${i}[${e.join("n,")}${e.length>0?"n":""}]`};return n})();function x(n,i){return n===i||E(n)===E(i)}function k(){let n=document.activeElement;if(n==null)return null;for(;n!=null&&n.shadowRoot!=null&&n.shadowRoot.activeElement!=null;)n=n.shadowRoot.activeElement;return n}function N(n){return h(()=>w(n)?!!j(n)?.closest("form"):!0)}function z(){const n=v(),i=h(()=>["#text","#comment"].includes(n.value?.$el.nodeName)?n.value?.$el.nextElementSibling:j(n));return{primitiveElement:n,currentElement:i}}const b="data-reka-collection-item";function D(n={}){const{key:i="",isProvider:e=!1}=n,t=`${i}CollectionProvider`;let r;if(e){const a=v(new Map);r={collectionRef:v(),itemMap:a},R(t,r)}else r=O(t);const o=(a=!1)=>{const l=r.collectionRef.value;if(!l)return[];const c=Array.from(l.querySelectorAll(`[${b}]`)),u=Array.from(r.itemMap.value.values()).sort((p,$)=>c.indexOf(p.ref)-c.indexOf($.ref));return a?u:u.filter(p=>p.ref.dataset.disabled!=="")},s=d({name:"CollectionSlot",setup(a,{slots:l}){const{primitiveElement:c,currentElement:m}=z();return C(m,()=>{r.collectionRef.value=m.value}),()=>g(A,{ref:c},l)}}),f=d({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:l,attrs:c}){const{primitiveElement:m,currentElement:u}=z();return I(p=>{if(u.value){const $=M(u.value);r.itemMap.value.set($,{ref:u.value,value:a.value}),p(()=>r.itemMap.value.delete($))}}),()=>g(A,{...c,[b]:"",ref:m},l)}}),y=h(()=>Array.from(r.itemMap.value.values())),S=h(()=>r.itemMap.value.size);return{getItems:o,reactiveItems:y,itemMapSize:S,CollectionSlot:s,CollectionItem:f}}export{D as a,z as b,k as g,x as i,N as u};
