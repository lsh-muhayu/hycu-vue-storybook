import{u as G,V as L}from"./VisuallyHidden-D8VxrnE7.js";import{a as j,c as x,P as R}from"./Primitive-CY0unASM.js";import{g as E,a as V,b as Y}from"./Collection-CmNR9omn.js";import{u as z}from"./useDirection-Cy6lobqq.js";import{d as S,G as J,r as q,p as I,o as m,q as F,i as O,u as v,h as $,e as _,A as W,J as Q,C as X,w as Z,z as w,c as T,y as ee,F as C,v as te}from"./iframe-C4A3u57P.js";const re="rovingFocusGroup.onEntryFocus",ae={bubbles:!1,cancelable:!0},ne={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ue(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function oe(n,e,r){const a=ue(n.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return ne[a]}function k(n,e=!1){const r=E();for(const a of n)if(a===r||(a.focus({preventScroll:e}),E()!==r))return}function le(n,e){return n.map((r,a)=>n[(e+a)%n.length])}const[se,ie]=x("RovingFocusGroup");var de=S({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(n,{expose:e,emit:r}){const a=n,u=r,{loop:s,orientation:i,dir:f}=J(a),y=z(f),t=j(a,"currentTabStopId",u,{defaultValue:a.defaultCurrentTabStopId,passive:a.currentTabStopId===void 0}),o=q(!1),l=q(!1),d=q(0),{getItems:A,CollectionSlot:P}=V({isProvider:!0});function K(c){const b=!l.value;if(c.currentTarget&&c.target===c.currentTarget&&b&&!o.value){const g=new CustomEvent(re,ae);if(c.currentTarget.dispatchEvent(g),u("entryFocus",g),!g.defaultPrevented){const h=A().map(p=>p.ref).filter(p=>p.dataset.disabled!==""),M=h.find(p=>p.getAttribute("data-active")===""),H=h.find(p=>p.getAttribute("data-highlighted")===""),N=h.find(p=>p.id===t.value),U=[M,H,N,...h].filter(Boolean);k(U,a.preventScrollOnEntryFocus)}}l.value=!1}function D(){setTimeout(()=>{l.value=!1},1)}return e({getItems:A}),ie({loop:s,dir:y,orientation:i,currentTabStopId:t,onItemFocus:c=>{t.value=c},onItemShiftTab:()=>{o.value=!0},onFocusableItemAdd:()=>{d.value++},onFocusableItemRemove:()=>{d.value--}}),(c,b)=>(m(),I(v(P),null,{default:F(()=>[O(v(R),{tabindex:o.value||d.value===0?-1:0,"data-orientation":v(i),as:c.as,"as-child":c.asChild,dir:v(y),style:{outline:"none"},onMousedown:b[0]||(b[0]=g=>l.value=!0),onMouseup:D,onFocus:K,onBlur:b[1]||(b[1]=g=>o.value=!1)},{default:F(()=>[$(c.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),Ie=de,ce=S({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(n){const e=n,r=se(),a=G(),u=_(()=>e.tabStopId||a),s=_(()=>r.currentTabStopId.value===u.value),{getItems:i,CollectionItem:f}=V();W(()=>{e.focusable&&r.onFocusableItemAdd()}),Q(()=>{e.focusable&&r.onFocusableItemRemove()});function y(t){if(t.key==="Tab"&&t.shiftKey){r.onItemShiftTab();return}if(t.target!==t.currentTarget)return;const o=oe(t,r.orientation.value,r.dir.value);if(o!==void 0){if(t.metaKey||t.ctrlKey||t.altKey||!e.allowShiftKey&&t.shiftKey)return;t.preventDefault();let l=[...i().map(d=>d.ref).filter(d=>d.dataset.disabled!=="")];if(o==="last")l.reverse();else if(o==="prev"||o==="next"){o==="prev"&&l.reverse();const d=l.indexOf(t.currentTarget);l=r.loop.value?le(l,d+1):l.slice(d+1)}X(()=>k(l))}}return(t,o)=>(m(),I(v(f),null,{default:F(()=>[O(v(R),{tabindex:s.value?0:-1,"data-orientation":v(r).orientation.value,"data-active":t.active?"":void 0,"data-disabled":t.focusable?void 0:"",as:t.as,"as-child":t.asChild,onMousedown:o[0]||(o[0]=l=>{t.focusable?v(r).onItemFocus(u.value):l.preventDefault()}),onFocus:o[1]||(o[1]=l=>v(r).onItemFocus(u.value)),onKeydown:y},{default:F(()=>[$(t.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),_e=ce,fe=S({inheritAttrs:!1,__name:"VisuallyHiddenInputBubble",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(n){const e=n,{primitiveElement:r,currentElement:a}=Y(),u=_(()=>e.checked??e.value);return Z(u,(s,i)=>{if(!a.value)return;const f=a.value,y=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(y,"value").set;if(o&&s!==i){const l=new Event("input",{bubbles:!0}),d=new Event("change",{bubbles:!0});o.call(f,s),f.dispatchEvent(l),f.dispatchEvent(d)}}),(s,i)=>(m(),I(L,w({ref_key:"primitiveElement",ref:r},{...e,...s.$attrs},{as:"input"}),null,16))}}),B=fe,pe=S({inheritAttrs:!1,__name:"VisuallyHiddenInput",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(n){const e=n,r=_(()=>typeof e.value=="object"&&Array.isArray(e.value)&&e.value.length===0&&e.required),a=_(()=>typeof e.value=="string"||typeof e.value=="number"||typeof e.value=="boolean"||e.value===null||e.value===void 0?[{name:e.name,value:e.value}]:typeof e.value=="object"&&Array.isArray(e.value)?e.value.flatMap((u,s)=>typeof u=="object"?Object.entries(u).map(([i,f])=>({name:`${e.name}[${s}][${i}]`,value:f})):{name:`${e.name}[${s}]`,value:u}):e.value!==null&&typeof e.value=="object"&&!Array.isArray(e.value)?Object.entries(e.value).map(([u,s])=>({name:`${e.name}[${u}]`,value:s})):[]);return(u,s)=>(m(),T(C,null,[ee(" We render single input if it's required "),r.value?(m(),I(B,w({key:u.name},{...e,...u.$attrs},{name:u.name,value:u.value}),null,16,["name","value"])):(m(!0),T(C,{key:1},te(a.value,i=>(m(),I(B,w({key:i.name},{ref_for:!0},{...e,...u.$attrs},{name:i.name,value:i.value}),null,16,["name","value"]))),128))],2112))}}),he=pe;export{_e as R,he as V,Ie as a};
