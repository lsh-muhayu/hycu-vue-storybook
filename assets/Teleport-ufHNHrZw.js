import{i as _,u as F,q as S,P as k,s as W}from"./Primitive-lO3X1-rN.js";import{h as L}from"./useForwardPropsEmits-BCr5c5ya.js";import{r as w,m as E,U as h,C as b,d as C,e as D,R as I,p as g,o as T,q as x,h as B,u as v,x as A,y as M,a6 as R}from"./iframe-Cz7ZjfuJ.js";const z="dismissableLayer.pointerDownOutside",U="dismissableLayer.focusOutside";function q(o,a){const s=a.closest("[data-dismissable-layer]"),e=o.dataset.dismissableLayer===""?o:o.querySelector("[data-dismissable-layer]"),n=Array.from(o.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(s&&(e===s||n.indexOf(e)<n.indexOf(s)))}function K(o,a,s=!0){const e=a?.value?.ownerDocument??globalThis?.document,n=w(!1),r=w(()=>{});return E(l=>{if(!_||!h(s))return;const i=async c=>{const p=c.target;if(!(!a?.value||!p)){if(q(a.value,p)){n.value=!1;return}if(c.target&&!n.value){let y=function(){L(z,o,O)};const O={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",r.value),r.value=y,e.addEventListener("click",r.value,{once:!0})):y()}else e.removeEventListener("click",r.value);n.value=!1}},d=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);l(()=>{window.clearTimeout(d),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.value)})}),{onPointerDownCapture:()=>{h(s)&&(n.value=!0)}}}function N(o,a,s=!0){const e=a?.value?.ownerDocument??globalThis?.document,n=w(!1);return E(r=>{if(!_||!h(s))return;const l=async i=>{if(!a?.value)return;await b(),await b();const d=i.target;!a.value||!d||q(a.value,d)||i.target&&!n.value&&L(U,o,{originalEvent:i})};e.addEventListener("focusin",l),r(()=>e.removeEventListener("focusin",l))}),{onFocusCapture:()=>{h(s)&&(n.value=!0)},onBlurCapture:()=>{h(s)&&(n.value=!1)}}}const u=I({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set});var H=C({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(o,{emit:a}){const s=o,e=a,{forwardRef:n,currentElement:r}=F(),l=D(()=>r.value?.ownerDocument??globalThis.document),i=D(()=>u.layersRoot),d=D(()=>r.value?Array.from(i.value).indexOf(r.value):-1),c=D(()=>u.layersWithOutsidePointerEventsDisabled.size>0),p=D(()=>{const t=Array.from(i.value),[f]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),m=t.indexOf(f);return d.value>=m}),O=K(async t=>{const f=[...u.branches].some(m=>m?.contains(t.target));!p.value||f||(e("pointerDownOutside",t),e("interactOutside",t),await b(),t.defaultPrevented||e("dismiss"))},r),y=N(t=>{[...u.branches].some(m=>m?.contains(t.target))||(e("focusOutside",t),e("interactOutside",t),t.defaultPrevented||e("dismiss"))},r);S("Escape",t=>{d.value===i.value.size-1&&(e("escapeKeyDown",t),t.defaultPrevented||e("dismiss"))});let P;return E(t=>{r.value&&(s.disableOutsidePointerEvents&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(P=l.value.body.style.pointerEvents,l.value.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(r.value)),i.value.add(r.value),t(()=>{s.disableOutsidePointerEvents&&u.layersWithOutsidePointerEventsDisabled.size===1&&(l.value.body.style.pointerEvents=P)}))}),E(t=>{t(()=>{r.value&&(i.value.delete(r.value),u.layersWithOutsidePointerEventsDisabled.delete(r.value))})}),(t,f)=>(T(),g(v(k),{ref:v(n),"as-child":t.asChild,as:t.as,"data-dismissable-layer":"",style:A({pointerEvents:c.value?p.value?"auto":"none":void 0}),onFocusCapture:v(y).onFocusCapture,onBlurCapture:v(y).onBlurCapture,onPointerdownCapture:v(O).onPointerDownCapture},{default:x(()=>[B(t.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),J=H,V=C({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(o){const a=W();return(s,e)=>v(a)||s.forceMount?(T(),g(R,{key:0,to:s.to,disabled:s.disabled,defer:s.defer},[B(s.$slots,"default")],8,["to","disabled","defer"])):M("v-if",!0)}}),Q=V;export{J as D,Q as T};
